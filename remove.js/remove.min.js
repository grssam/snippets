/*
 Copyright (C) 2013 Girish Sharma <scrapmachines@gmail.com>
 This Source Code Form is subject to the terms of the Mozilla Public
 License, v. 2.0. If a copy of the MPL was not distributed with this file,
 You can obtain one at http://mozilla.org/MPL/2.0/.
*/
(function(a,b){if(typeof define==="function"&&define.amd){define(["exports"],b)}else{if(typeof exports!=="undefined"){b(exports)}else{b((a.remove={}))}}}(this,function(a){var b={};function d(k,m){b=m||{comparison:"",whiteList:[]};var h=k.split(/[ _=]+/g).length,g=f(k),j=g.length,n=b.COEFF_LENGTH_MIN||0.5,i=b.COEFF_LENGTH_MAX||0.75;if(g+""=="true"||(j>=n*h&&h<5)||(j>=i*h&&h>=5)){var l=b.comparison||"";if(l.split(/[\/]/g).length>3){return k}return c(k,l.split(/[\/]/g))}else{if(g+""!="false"&&g+""!="true"&&((j<0.6*n*h||k.indexOf("=")<0&&j<=n*h)&&h<=8||j<0.75*n*h&&h>8)){return k.split(/[ _]/g).filter(function(o,p){return g.indexOf(p)<0}).join(" ")}}return k}function f(l){var k=l.split(/[ _]/g),q=k.length;if(q>1){var t=0,n=0,r=[];for(var m=0;m<q;m++){n=f(k[m])==true?1:0;t+=n;if(n==1){r.push(m)}}return t==0?false:r}else{if(l.split(".").length>1&&l.split(".").length<4){return f(l.replace("."," "))==false?false:true}else{if(l.indexOf("/")>=0){return false}var o=["http","https","id","aurora","xpcom","hawaii","src","sdk","string"];o.push.apply(b.whiteList);var j=0,p=0,s=0,h=false;l=l.toLowerCase();var g=l.length;j=l.split(/[^0-9]/).length-1;p=g-j;if(g<6&&j<=2){return false}else{if(g>=6&&((j>2&&p>0&&j<g-1)||(j==0))){return true}}s=l.split(/[aeiouyаеёиоуыэюяAЕЁИОУЫЭЮЯ]/).length-1;if(s>1){l.split(/[aeiouyаеёиоуыэюяAЕЁИОУЫЭЮЯ]/).some(function(i){if(f(i)){h=true;return true}})}if(p<=2&&l.split(/[0-9]/g).length<=2&&((g<6&&s>0&&!h)||(g>=6&&p<=2&&s>0&&!h&&j/s<5&&j/s>1.5))){return false}else{if(o.indexOf(l.toLowerCase())>=0){return false}}return true}}}function c(n,j){n=n.split(/\s+/);j=(j||[]).filter(function(i){return i.length>3||i.match(/[0-9]+/)});var k=0,g,h=j.length;function l(p){if(p==n[k+1]||p==n[k+2]){return true}p=p.toLowerCase().replace(/[^0-9a-zA-Z\u0400-\u04FF\u0500-\u052F]+/g,"");for(var i=0;i<h;i++){try{if(p.search(j[i])>=0||j[i].search(p)>=0){return true}}catch(o){}}return false}j=j.map(function(i){return i.toLowerCase().replace(/[^0-9a-zA-Z\u0400-\u04FF\u0500-\u052F]+/g,"")});k=0;var m=n.length;while(k<m){if(l(n[k])&&(k<2||k>Math.max(m-3,0.75*m))){n.splice(k,1);k=0;m=n.length}else{k++}}g=n.length;k=0;while(k<g){n[k]=n[k].replace(/[^a-zA-Z0-9\u0400-\u04FF\u0500-\u052F]+$/,"").replace(/^[^a-zA-Z0-9\u0400-\u04FF\u0500-\u052F]+/,"");if(((k==0||k==g-1)&&n[k].search(/^[^a-zA-Z0-9\u0400-\u04FF\u0500-\u052F]+$/)>=0)||(k==g-1&&n[k].search(/^(the|a|an|for)$/i)>=0)){n.splice(k,1);k=Math.max(k-2,0);g=n.length}else{k++}}return n.filter(function(i){return i.length}).join(" ")}function e(o,j,g){if(o==null){return null}function p(t){var r=0;for(var s=0;s<t.length;s++){r+=t[s].length+1}return --r}j=j||40;var h=j;if(g==null){g=true}if(o.length>j){var q=o.split(" "),i="";if(q.length>1){var n=-1;Array.some(q,function(r){if(i.length>2*j/3){return true}else{if(i.length+r.length<2*j/3){i+=r+" ";h-=(r.length+1);n++}else{return true}}});if(n==-1){var m=q[0].length/p(q);i=e(q[0],j*m,true)+" ";h-=i.length;n++}if(q.length>2){i+="… ";h-=2}if(n<q.length-1){var l=q.length-1,k="";while(h>q[l].length&&l>n){k=" "+q[l]+k;h-=(q[l--].length+1)}if(l-n<=1){i=i.replace(" … "," ");h+=2}if(l>n&&h>2){k=e(q[l],h,false)+k}i+=k}return i}else{if(g==false){return"…"+o.slice(o.length-j+1,o.length)}else{if(g==true){return o.slice(0,j-1)+"…"}}}}return o}if(typeof $!=="undefined"&&!!$.fn){$.fn.rG=$.fn.removeGibberish=function(g){var h=$.extend({whiteList:[],COEFF_LENGTH_MIN:0.5,COEFF_LENGTH_MAX:0.75},g);return $(this).map(function(){return d(this,h)})};$.fn.rR=$.fn.removeRedundant=function(g){return $(this).map(function(){return c(this,g||[])})};$.fn.rC=$.fn.removeCharacters=function(g,h){return $(this).map(function(){return e(this,g,h)})}}a.gibberish=d;a.redundant=c;a.characters=e;return a}));
